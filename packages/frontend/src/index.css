/* Neon Auth UI styles - must be first */
@import '@neondatabase/neon-js/ui/css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/**
 * Neon Auth UI CSS Overrides
 * Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8
 * 
 * Override Neon Auth UI styles to match the platform's paper-clean aesthetic:
 * - Font families: Inter for body, Source Serif 4 for headings
 * - Colors: Platform color scheme (text-primary, accent, support, oppose)
 * - Border radius: Subtle (2px) and small (4px) for paper-clean look
 * - Error/success states: oppose (#DC2626) and support (#059669)
 */

/* Root CSS custom properties for Neon Auth UI */
:root {
  /* Typography - Requirements: 3.1, 3.3 */
  --auth-font-family: 'Inter', 'IBM Plex Sans', system-ui, sans-serif;
  --auth-heading-font-family: 'Source Serif 4', 'Literata', Georgia, serif;

  /* Colors - Requirements: 3.2, 3.4 - Paper-clean palette */
  --auth-background: #FFFFFF;
  --auth-foreground: #111111;
  --auth-muted: #6B7280;
  --auth-muted-foreground: #9CA3AF;
  --auth-primary: #111111;
  --auth-primary-foreground: #FFFFFF;
  --auth-accent: #2563EB;
  --auth-accent-foreground: #FFFFFF;
  --auth-destructive: #DC2626;
  --auth-success: #059669;
  --auth-border: rgba(0, 0, 0, 0.08);
  --auth-ring: #2563EB;
  --auth-input-bg: #FAFAF9;

  /* Spacing & Radius - Requirements: 3.4 - Paper-clean subtle radius */
  --auth-radius: 4px;
  --auth-radius-lg: 6px;
}

/* Neon Auth form container styling */
[data-auth-view],
.neon-auth-view {
  font-family: var(--auth-font-family) !important;
}

/* Auth form headings - Requirements: 3.3 */
[data-auth-view] h1,
[data-auth-view] h2,
[data-auth-view] h3,
.neon-auth-view h1,
.neon-auth-view h2,
.neon-auth-view h3 {
  font-family: var(--auth-heading-font-family) !important;
  color: var(--auth-foreground) !important;
}

/* Auth form inputs - Requirements: 3.1, 3.4 - Paper-clean styling */
[data-auth-view] input,
[data-auth-view] textarea,
.neon-auth-view input,
.neon-auth-view textarea {
  font-family: var(--auth-font-family) !important;
  font-size: 0.9375rem !important;
  border-radius: var(--auth-radius) !important;
  border: 1px solid var(--auth-border) !important;
  background-color: var(--auth-input-bg) !important;
  color: var(--auth-foreground) !important;
  padding: 0.75rem 1rem !important;
  transition: border-color 0.15s ease, box-shadow 0.15s ease, background-color 0.15s ease !important;
}

[data-auth-view] input:hover,
[data-auth-view] textarea:hover,
.neon-auth-view input:hover,
.neon-auth-view textarea:hover {
  border-color: rgba(0, 0, 0, 0.15) !important;
  background-color: var(--auth-background) !important;
}

[data-auth-view] input:focus,
[data-auth-view] textarea:focus,
.neon-auth-view input:focus,
.neon-auth-view textarea:focus {
  border-color: var(--auth-ring) !important;
  background-color: var(--auth-background) !important;
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1) !important;
  outline: none !important;
}

[data-auth-view] input::placeholder,
[data-auth-view] textarea::placeholder,
.neon-auth-view input::placeholder,
.neon-auth-view textarea::placeholder {
  color: var(--auth-muted-foreground) !important;
}

/* Auth form labels - Requirements: 3.1 */
[data-auth-view] label,
.neon-auth-view label {
  font-family: var(--auth-font-family) !important;
  color: var(--auth-foreground) !important;
  font-size: 0.875rem !important;
  font-weight: 500 !important;
}

/* Primary buttons (Sign In, Sign Up) - Requirements: 3.2 - Paper-clean styling */
[data-auth-view] button[type="submit"],
[data-auth-view] button[data-primary],
.neon-auth-view button[type="submit"],
.neon-auth-view button[data-primary] {
  font-family: var(--auth-font-family) !important;
  font-size: 0.9375rem !important;
  background-color: var(--auth-primary) !important;
  color: var(--auth-primary-foreground) !important;
  border: none !important;
  border-radius: var(--auth-radius) !important;
  font-weight: 500 !important;
  padding: 0.75rem 1.5rem !important;
  width: 100% !important;
  transition: background-color 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease !important;
}

[data-auth-view] button[type="submit"]:hover,
[data-auth-view] button[data-primary]:hover,
.neon-auth-view button[type="submit"]:hover,
.neon-auth-view button[data-primary]:hover {
  background-color: #262626 !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
}

[data-auth-view] button[type="submit"]:active,
[data-auth-view] button[data-primary]:active,
.neon-auth-view button[type="submit"]:active,
.neon-auth-view button[data-primary]:active {
  transform: scale(0.98) !important;
  box-shadow: none !important;
}

[data-auth-view] button[type="submit"]:disabled,
[data-auth-view] button[data-primary]:disabled,
.neon-auth-view button[type="submit"]:disabled,
.neon-auth-view button[data-primary]:disabled {
  background-color: #D1D5DB !important;
  color: #9CA3AF !important;
  cursor: not-allowed !important;
  box-shadow: none !important;
}

/* OAuth/Social buttons - Requirements: 3.7 - Paper-clean styling */
[data-auth-view] button[data-social],
[data-auth-view] [data-oauth-button],
.neon-auth-view button[data-social],
.neon-auth-view [data-oauth-button] {
  font-family: var(--auth-font-family) !important;
  font-size: 0.9375rem !important;
  background-color: var(--auth-background) !important;
  color: var(--auth-foreground) !important;
  border: 1px solid var(--auth-border) !important;
  border-radius: var(--auth-radius) !important;
  font-weight: 500 !important;
  padding: 0.75rem 1rem !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 0.75rem !important;
  width: 100% !important;
  transition: background-color 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease !important;
}

[data-auth-view] button[data-social]:hover,
[data-auth-view] [data-oauth-button]:hover,
.neon-auth-view button[data-social]:hover,
.neon-auth-view [data-oauth-button]:hover {
  background-color: #F7F6F2 !important;
  border-color: rgba(0, 0, 0, 0.12) !important;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04) !important;
}

[data-auth-view] button[data-social]:active,
[data-auth-view] [data-oauth-button]:active,
.neon-auth-view button[data-social]:active,
.neon-auth-view [data-oauth-button]:active {
  background-color: #F0EFEB !important;
  transform: scale(0.99) !important;
}

/* Google button icon sizing */
[data-auth-view] button[data-social] svg,
[data-auth-view] button[data-social] img,
[data-auth-view] [data-oauth-button] svg,
[data-auth-view] [data-oauth-button] img,
.neon-auth-view button[data-social] svg,
.neon-auth-view button[data-social] img,
.neon-auth-view [data-oauth-button] svg,
.neon-auth-view [data-oauth-button] img {
  width: 1.25rem !important;
  height: 1.25rem !important;
  flex-shrink: 0 !important;
}

/* Error messages - Requirements: 3.5 */
[data-auth-view] [data-error],
[data-auth-view] [role="alert"],
[data-auth-view] .error,
[data-auth-view] [data-state="error"],
.neon-auth-view [data-error],
.neon-auth-view [role="alert"],
.neon-auth-view .error,
.neon-auth-view [data-state="error"] {
  color: var(--auth-destructive) !important;
  font-family: var(--auth-font-family) !important;
  font-size: 0.875rem !important;
}

/* Error state for inputs */
[data-auth-view] input[data-state="error"],
[data-auth-view] input[aria-invalid="true"],
.neon-auth-view input[data-state="error"],
.neon-auth-view input[aria-invalid="true"] {
  border-color: var(--auth-destructive) !important;
}

[data-auth-view] input[data-state="error"]:focus,
[data-auth-view] input[aria-invalid="true"]:focus,
.neon-auth-view input[data-state="error"]:focus,
.neon-auth-view input[aria-invalid="true"]:focus {
  border-color: var(--auth-destructive) !important;
  box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.2) !important;
}

/* Success messages - Requirements: 3.6 */
[data-auth-view] [data-success],
[data-auth-view] [data-state="success"],
[data-auth-view] .success,
.neon-auth-view [data-success],
.neon-auth-view [data-state="success"],
.neon-auth-view .success {
  color: var(--auth-success) !important;
  font-family: var(--auth-font-family) !important;
  font-size: 0.875rem !important;
}

/* Success state for inputs */
[data-auth-view] input[data-state="success"],
.neon-auth-view input[data-state="success"] {
  border-color: var(--auth-success) !important;
}

[data-auth-view] input[data-state="success"]:focus,
.neon-auth-view input[data-state="success"]:focus {
  border-color: var(--auth-success) !important;
  box-shadow: 0 0 0 2px rgba(5, 150, 105, 0.2) !important;
}

/* Links - Requirements: 3.8 */
[data-auth-view] a,
[data-auth-view] button[data-link],
.neon-auth-view a,
.neon-auth-view button[data-link] {
  color: var(--auth-accent) !important;
  font-family: var(--auth-font-family) !important;
  text-decoration: none !important;
  transition: color 0.15s ease !important;
}

[data-auth-view] a:hover,
[data-auth-view] button[data-link]:hover,
.neon-auth-view a:hover,
.neon-auth-view button[data-link]:hover {
  color: #1D4ED8 !important;
  text-decoration: underline !important;
}

/* Divider/separator styling */
[data-auth-view] [data-separator],
[data-auth-view] hr,
.neon-auth-view [data-separator],
.neon-auth-view hr {
  border-color: var(--auth-border) !important;
}

[data-auth-view] [data-separator-text],
.neon-auth-view [data-separator-text] {
  color: var(--auth-muted) !important;
  font-family: var(--auth-font-family) !important;
  font-size: 0.75rem !important;
  text-transform: uppercase !important;
  letter-spacing: 0.05em !important;
}

/* Form container background - Requirements: 3.4 */
[data-auth-view] [data-form-container],
[data-auth-view] form,
.neon-auth-view [data-form-container],
.neon-auth-view form {
  background-color: var(--auth-background) !important;
}

/* Secondary/muted text */
[data-auth-view] [data-muted],
[data-auth-view] p,
.neon-auth-view [data-muted],
.neon-auth-view p {
  color: var(--auth-muted) !important;
  font-family: var(--auth-font-family) !important;
}

/* Loading spinner styling */
[data-auth-view] [data-loading],
[data-auth-view] [role="progressbar"],
.neon-auth-view [data-loading],
.neon-auth-view [role="progressbar"] {
  color: var(--auth-primary) !important;
}

/* Toggle between sign-in/sign-up text */
[data-auth-view] [data-toggle-view],
.neon-auth-view [data-toggle-view] {
  font-family: var(--auth-font-family) !important;
  color: var(--auth-muted) !important;
}

[data-auth-view] [data-toggle-view] button,
[data-auth-view] [data-toggle-view] a,
.neon-auth-view [data-toggle-view] button,
.neon-auth-view [data-toggle-view] a {
  color: var(--auth-accent) !important;
  font-weight: 500 !important;
}

/* ============================================
   Compact Auth Modal Styles
   Paper-minimal clean design
   ============================================ */

/* Override CSS variables for shadcn/ui components */
.auth-modal-compact,
.auth-modal-compact * {
  --input: 0 0% 100%;
  --background: 0 0% 100%;
  --card: 0 0% 100%;
  --foreground: 0 0% 7%;
  --primary: 0 0% 7%;
  --primary-foreground: 0 0% 100%;
  --muted: 40 20% 96%;
  --muted-foreground: 220 9% 46%;
  --border: 0 0% 0% / 0.1;
  --ring: 221 83% 53%;
  --radius: 4px;
}

/* Ensure inputs have white background */
.auth-modal-compact input {
  background-color: #FFFFFF !important;
  background: #FFFFFF !important;
}

/* Constrain OAuth button icons */
.auth-modal-compact button svg,
.auth-modal-compact button img {
  width: 18px !important;
  height: 18px !important;
  max-width: 18px !important;
  max-height: 18px !important;
  flex-shrink: 0 !important;
}

/* Icon wrapper constraint */
.auth-modal-compact button > div:first-child:has(svg),
.auth-modal-compact button > span:first-child:has(svg) {
  width: 18px !important;
  height: 18px !important;
  overflow: hidden !important;
}

@layer base {
  html {
    @apply bg-page-bg;
    /* Minimal scrollbar for webkit browsers */
    scrollbar-width: thin;
    scrollbar-color: rgba(0, 0, 0, 0.15) transparent;
  }

  @supports (content-visibility: auto) {
    [data-testid="compact-debate-card"],
    [data-testid="trending-item"] {
      content-visibility: auto;
      contain-intrinsic-size: 140px;
    }
  }

  body {
    @apply font-body text-text-primary antialiased;
    /* Base body text line-height for optimal readability
       Requirements: 1.3 - Body text line-height 1.6-1.8 */
    line-height: 1.7;
  }
  
  /* Base heading styles with refined line-heights
     Requirements: 1.3, 1.5 - Clear typographic hierarchy */
  h1, h2, h3, h4, h5, h6 {
    @apply font-heading text-text-primary;
  }
  
  h1 {
    line-height: 1.25;
  }
  
  h2 {
    line-height: 1.3;
  }
  
  h3, h4, h5, h6 {
    line-height: 1.35;
  }
  
  /* Paragraph text with proper line-height */
  p {
    line-height: 1.7;
  }

  /* Webkit scrollbar styling (Chrome, Safari, Edge) */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.15);
    border-radius: 4px;
    border: 2px solid transparent;
    background-clip: padding-box;
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: rgba(0, 0, 0, 0.25);
  }

  ::-webkit-scrollbar-corner {
    background: transparent;
  }

  /* Hide scrollbar arrows */
  ::-webkit-scrollbar-button {
    display: none;
  }
  
  /* Global focus-visible styles for keyboard navigation (Requirement 1.7) */
  /* Only show focus ring when using keyboard, not mouse */
  :focus-visible {
    @apply outline-none ring-2 ring-accent ring-offset-2 ring-offset-page-bg;
  }
  
  /* Remove default focus outline since we're using focus-visible */
  :focus:not(:focus-visible) {
    @apply outline-none ring-0;
  }
  
  /* Ensure buttons and interactive elements have visible focus */
  button:focus-visible,
  a:focus-visible,
  [role="button"]:focus-visible,
  [tabindex]:focus-visible {
    @apply outline-none ring-2 ring-accent ring-offset-2 ring-offset-page-bg;
  }
  
  /* Input/textarea focus - use border only (single line, no ring) */
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    @apply outline-none ring-0 ring-offset-0;
  }
  
  /* Special focus styles for modal elements */
  [role="dialog"]:focus-visible {
    @apply outline-none ring-2 ring-accent/50 ring-offset-0;
  }
}

@layer components {
  /* Typography - Headings (Serif) */
  .heading-1 {
    @apply font-heading text-heading-1 text-text-primary;
  }
  
  .heading-2 {
    @apply font-heading text-heading-2 text-text-primary;
  }
  
  .heading-3 {
    @apply font-heading text-heading-3 text-text-primary;
  }
  
  /* Typography - Body (Sans-serif) */
  .body-large {
    @apply font-body text-body-large text-text-primary;
  }
  
  .body-text {
    @apply font-body text-body text-text-primary;
  }
  
  .body-small {
    @apply font-body text-body-small text-text-primary;
  }
  
  /* Typography - UI Elements */
  .label-text {
    @apply font-body text-label uppercase tracking-wider text-text-secondary;
  }
  
  .caption-text {
    @apply font-body text-caption text-text-secondary;
  }
  
  /* Paper surface */
  .paper-surface {
    @apply bg-paper shadow-paper rounded-subtle;
  }
  
  /* Hairline border */
  .border-hairline {
    @apply border border-black/[0.08];
  }
  
  /* ============================================
     Paper Polish CSS Classes
     Requirements: 3.3, 4.1, 4.5
     ============================================ */
  
  /* Paper divider - subtle horizontal rule for section separation
     Requirements: 3.3 - Horizontal rule styling */
  .paper-divider {
    height: 1px;
    background-color: #E5E5E0;
    border: none;
    width: 100%;
    margin-top: 1.5rem;
    margin-bottom: 1.5rem;
  }
  
  /* Small-caps - academic/editorial style for status labels and metadata
     Requirements: 4.1 - Status label styling */
  .small-caps {
    font-variant: small-caps;
    text-transform: lowercase;
    letter-spacing: 0.05em;
  }
  
  /* Monospace label - refined metadata display
     Requirements: 4.5 - Metadata label letter-spacing */
  .monospace-label {
    font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace;
    font-size: 0.75rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
  }
}

@layer utilities {
  /* Animation utilities for toasts */
  .animate-in {
    animation: animate-in 0.2s ease-out;
  }
  
  .slide-in-from-right-5 {
    --tw-enter-translate-x: 1.25rem;
  }
  
  .fade-in {
    --tw-enter-opacity: 0;
  }
  
  @keyframes animate-in {
    from {
      opacity: var(--tw-enter-opacity, 1);
      transform: translateX(var(--tw-enter-translate-x, 0));
    }
  }
  
  /* Line clamp utility */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Subtle check animation for stance lock */
  .animate-check {
    animation: check-pop 0.3s ease-out;
  }
  
  @keyframes check-pop {
    0% {
      opacity: 0;
      transform: scale(0.5);
    }
    50% {
      transform: scale(1.2);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  /* Delta label animation for After stance */
  .animate-delta {
    animation: delta-slide 0.4s ease-out;
  }
  
  @keyframes delta-slide {
    0% {
      opacity: 0;
      transform: translateY(-8px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Subtle pulse for newly locked values */
  .animate-lock {
    animation: lock-pulse 0.5s ease-out;
  }
  
  @keyframes lock-pulse {
    0% {
      background-color: rgba(5, 150, 105, 0.1);
    }
    100% {
      background-color: transparent;
    }
  }
  
  /* Shake animation for error states */
  @keyframes shake {
    0%, 100% {
      transform: translateX(0);
    }
    10%, 30%, 50%, 70%, 90% {
      transform: translateX(-4px);
    }
    20%, 40%, 60%, 80% {
      transform: translateX(4px);
    }
  }
}
